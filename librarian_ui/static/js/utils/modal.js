// Generated by CoffeeScript 1.10.0
(function(window, $, templates) {
  var ESCAPE, body, modalContent;
  modalContent = templates.modalContent;
  body = $(document.body);
  ESCAPE = 27;
  body.on('click', '.o-modal-overlay', function(e) {
    var elem;
    elem = $(this);
    return elem.remove();
  });
  body.on('click', '.o-modal-close', function(e) {
    var elem;
    elem = $(this);
    return elem.parents('.o-modal-overlay').remove();
  });
  body.on('click', '.o-modal-window', function(e) {
    return e.stopPropagation();
  });
  body.on('keydown', '.o-modal-window', function(e) {
    var elem;
    elem = $(this);
    if (e.which === ESCAPE) {
      return elem.parents('.o-modal-overlay').remove();
    }
  });
  return $.modalContent = function(contentUrl, failureTemplate) {
    var modal, panel, res;
    $('#modal-content').remove();
    modal = $(templates.modalContent);
    modal.appendTo(body);
    window = modal.find('.o-modal-window');
    window.focus();
    panel = modal.find('.o-modal-panel');
    res = $.get(contentUrl);
    res.done(function(data) {
      return panel.html(data);
    });
    return res.fail(function() {
      return panel.html(failureTemplate);
    });
  };
})(this, this.jQuery, this.templates);
